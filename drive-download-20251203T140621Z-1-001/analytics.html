<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Analytics - FalconPro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:wght@400;600;700&family=Inter:wght@300;400;500;600;700&family=Cinzel:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --forest-green: #2D5016;
            --warm-amber: #D4A574;
            --stone-gray: #6B7280;
            --copper-brown: #B45309;
            --sky-blue: #7DD3FC;
            --alert-red: #EF4444;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--forest-green) 0%, #1a3009 50%, var(--forest-green) 100%);
            background-size: 400% 400%;
            animation: gradientShift 20s ease infinite;
            min-height: 100vh;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .nav-link {
            position: relative;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover {
            color: var(--warm-amber);
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--warm-amber);
            transition: width 0.3s ease;
        }
        
        .nav-link:hover::after {
            width: 100%;
        }
        
        .chart-container {
            height: 400px;
            opacity: 0;
            transform: translateY(20px);
        }
        
        .fade-in-up {
            animation: fadeInUp 0.6s ease forwards;
        }
        
        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .metric-card {
            transition: all 0.3s ease;
        }
        
        .metric-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .comparison-bird {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .comparison-bird:hover {
            transform: scale(1.05);
        }
        
        .comparison-bird.selected {
            border: 2px solid var(--warm-amber);
            background: rgba(212, 165, 116, 0.2);
        }
        
        .export-btn {
            transition: all 0.3s ease;
        }
        
        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 glass-card">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-amber-400 to-amber-600 rounded-lg flex items-center justify-center">
                        <span class="text-white font-bold text-lg">F</span>
                    </div>
                    <h1 class="text-xl font-bold text-white">FalconPro</h1>
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="index.html" class="nav-link text-white font-medium">Dashboard</a>
                    <a href="training.html" class="nav-link text-white font-medium">Training</a>
                    <a href="analytics.html" class="nav-link text-amber-400 font-medium">Analytics</a>
                    <a href="profiles.html" class="nav-link text-white font-medium">Profiles</a>
                    <a href="hood-generator.html" class="nav-link text-white font-medium">Hood Generator</a>
                </div>
                <div class="flex items-center space-x-3">
                    <img src="resources/falconer-portrait.jpg" alt="Falconer" class="w-8 h-8 rounded-full border-2 border-amber-400">
                    <span class="text-white text-sm hidden sm:block">Master Falconer</span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Analytics Header -->
    <section class="pt-24 pb-8 px-4">
        <div class="max-w-7xl mx-auto">
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-white mb-4">Performance Analytics</h1>
                <p class="text-gray-200 max-w-2xl mx-auto">
                    Comprehensive insights into your birds' training progress, health trends, and performance metrics.
                </p>
            </div>

            <!-- Key Metrics -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="metric-card glass-card rounded-xl p-6 text-center">
                    <div class="text-3xl font-bold text-blue-400 mb-2">89.2%</div>
                    <div class="text-gray-200 text-sm">Average Success Rate</div>
                    <div class="text-green-400 text-xs mt-1">‚Üë 5.3% from last month</div>
                </div>
                <div class="metric-card glass-card rounded-xl p-6 text-center">
                    <div class="text-3xl font-bold text-amber-400 mb-2">47</div>
                    <div class="text-gray-200 text-sm">Training Sessions</div>
                    <div class="text-green-400 text-xs mt-1">‚Üë 12 from last month</div>
                </div>
                <div class="metric-card glass-card rounded-xl p-6 text-center">
                    <div class="text-3xl font-bold text-green-400 mb-2">98.5%</div>
                    <div class="text-gray-200 text-sm">Weight Consistency</div>
                    <div class="text-green-400 text-xs mt-1">‚Üë 2.1% from last month</div>
                </div>
                <div class="metric-card glass-card rounded-xl p-6 text-center">
                    <div class="text-3xl font-bold text-purple-400 mb-2">15</div>
                    <div class="text-gray-200 text-sm">Active Birds</div>
                    <div class="text-gray-400 text-xs mt-1">No change</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Analytics Dashboard -->
    <section class="px-4 pb-12">
        <div class="max-w-7xl mx-auto">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                
                <!-- Main Charts Area -->
                <div class="lg:col-span-2 space-y-6">
                    
                    <!-- Weight Trends Chart -->
                    <div class="glass-card rounded-xl p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-semibold text-white">Weight Trends</h3>
                            <div class="flex space-x-2">
                                <button id="weightTimeRange7" class="px-3 py-1 text-sm bg-amber-600 text-white rounded-lg">7D</button>
                                <button id="weightTimeRange30" class="px-3 py-1 text-sm bg-gray-600 text-white rounded-lg">30D</button>
                                <button id="weightTimeRange90" class="px-3 py-1 text-sm bg-gray-600 text-white rounded-lg">90D</button>
                            </div>
                        </div>
                        <div id="weightTrendsChart" class="chart-container"></div>
                    </div>

                    <!-- Training Performance Chart -->
                    <div class="glass-card rounded-xl p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-semibold text-white">Training Performance</h3>
                            <select id="performanceBirdSelect" class="px-3 py-1 bg-white bg-opacity-20 text-white rounded-lg border border-gray-400">
                                <option value="all">All Birds</option>
                                <!-- Options populated by JavaScript -->
                            </select>
                        </div>
                        <div id="performanceChart" class="chart-container"></div>
                    </div>

                    <!-- Training Type Distribution -->
                    <div class="glass-card rounded-xl p-6">
                        <h3 class="text-xl font-semibold text-white mb-6">Training Type Distribution</h3>
                        <div id="trainingTypeChart" class="chart-container"></div>
                    </div>
                </div>

                <!-- Sidebar -->
                <div class="space-y-6">
                    
                    <!-- Bird Comparison -->
                    <div class="glass-card rounded-xl p-6">
                        <h3 class="text-lg font-semibold text-white mb-4">Bird Comparison</h3>
                        <div id="birdComparison" class="space-y-3">
                            <!-- Comparison birds will be populated by JavaScript -->
                        </div>
                        <button id="compareBirdsBtn" class="w-full mt-4 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg transition-colors">
                            Compare Selected
                        </button>
                    </div>

                    <!-- Performance Rankings -->
                    <div class="glass-card rounded-xl p-6">
                        <h3 class="text-lg font-semibold text-white mb-4">Performance Rankings</h3>
                        <div id="performanceRankings" class="space-y-3">
                            <!-- Rankings will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Health Alerts -->
                    <div class="glass-card rounded-xl p-6">
                        <h3 class="text-lg font-semibold text-white mb-4">Health Monitoring</h3>
                        <div id="healthAlerts" class="space-y-3">
                            <!-- Health alerts will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Export Options -->
                    <div class="glass-card rounded-xl p-6">
                        <h3 class="text-lg font-semibold text-white mb-4">Export Data</h3>
                        <div class="space-y-3">
                            <button class="export-btn w-full bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg transition-colors">
                                Export Training Log
                            </button>
                            <button class="export-btn w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg transition-colors">
                                Export Weight History
                            </button>
                            <button class="export-btn w-full bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-lg transition-colors">
                                Generate Report
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Detailed Analysis -->
            <div class="mt-8">
                <div class="glass-card rounded-xl p-6">
                    <h3 class="text-xl font-semibold text-white mb-6">Detailed Performance Analysis</h3>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        
                        <!-- Success Rate by Training Type -->
                        <div>
                            <h4 class="text-lg font-medium text-white mb-4">Success Rate by Training Type</h4>
                            <div id="successByTypeChart" class="chart-container"></div>
                        </div>
                        
                        <!-- Weight vs Performance Correlation -->
                        <div>
                            <h4 class="text-lg font-medium text-white mb-4">Weight vs Performance</h4>
                            <div id="weightPerformanceChart" class="chart-container"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        let selectedBirdsForComparison = [];
        let weightTrendsChart, performanceChart, trainingTypeChart, successByTypeChart, weightPerformanceChart;

        document.addEventListener('DOMContentLoaded', function() {
            initializeAnalytics();
        });

        function initializeAnalytics() {
            populateBirdSelects();
            renderBirdComparison();
            renderPerformanceRankings();
            renderHealthAlerts();
            initializeCharts();
            setupEventListeners();
            animateOnLoad();
        }

        function populateBirdSelects() {
            const select = document.getElementById('performanceBirdSelect');
            select.innerHTML = '<option value="all">All Birds</option>';
            
            window.falconryApp.birdDatabase.forEach(bird => {
                const option = document.createElement('option');
                option.value = bird.id;
                option.textContent = bird.name;
                select.appendChild(option);
            });
        }

        function renderBirdComparison() {
            const container = document.getElementById('birdComparison');
            container.innerHTML = '';
            
            window.falconryApp.birdDatabase.slice(0, 6).forEach(bird => {
                const card = document.createElement('div');
                card.className = 'comparison-bird glass-card rounded-lg p-3 flex items-center space-x-3';
                card.onclick = () => toggleBirdSelection(bird, card);
                
                card.innerHTML = `
                    <img src="${bird.image}" alt="${bird.name}" class="w-10 h-10 rounded-lg object-cover">
                    <div class="flex-1">
                        <p class="text-white text-sm font-medium">${bird.name}</p>
                        <p class="text-gray-300 text-xs">${bird.species}</p>
                    </div>
                    <div class="text-right">
                        <p class="text-white text-sm">${bird.weight}g</p>
                        <p class="text-gray-300 text-xs">${bird.trainingLevel}</p>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }

        function toggleBirdSelection(bird, card) {
            const index = selectedBirdsForComparison.findIndex(b => b.id === bird.id);
            
            if (index > -1) {
                selectedBirdsForComparison.splice(index, 1);
                card.classList.remove('selected');
            } else {
                if (selectedBirdsForComparison.length < 3) {
                    selectedBirdsForComparison.push(bird);
                    card.classList.add('selected');
                } else {
                    window.falconryApp.showNotification('Maximum 3 birds can be compared', 'error');
                }
            }
        }

        function renderPerformanceRankings() {
            const container = document.getElementById('performanceRankings');
            container.innerHTML = '';
            
            // Calculate performance scores
            const rankedBirds = window.falconryApp.birdDatabase.map(bird => {
                const sessions = window.falconryApp.getTrainingSessionsByBirdId(bird.id);
                const avgSuccess = sessions.length > 0 ? 
                    sessions.reduce((sum, session) => sum + session.success, 0) / sessions.length : 0;
                
                return { ...bird, avgSuccess };
            }).sort((a, b) => b.avgSuccess - a.avgSuccess);
            
            rankedBirds.slice(0, 5).forEach((bird, index) => {
                const rankElement = document.createElement('div');
                rankElement.className = 'flex items-center justify-between p-3 bg-white bg-opacity-10 rounded-lg';
                
                const medals = ['ü•á', 'ü•à', 'ü•â', '4Ô∏è‚É£', '5Ô∏è‚É£'];
                
                rankElement.innerHTML = `
                    <div class="flex items-center space-x-3">
                        <span class="text-lg">${medals[index]}</span>
                        <img src="${bird.image}" alt="${bird.name}" class="w-8 h-8 rounded-lg object-cover">
                        <span class="text-white font-medium">${bird.name}</span>
                    </div>
                    <span class="text-amber-400 font-bold">${Math.round(bird.avgSuccess)}%</span>
                `;
                
                container.appendChild(rankElement);
            });
        }

        function renderHealthAlerts() {
            const container = document.getElementById('healthAlerts');
            container.innerHTML = '';
            
            const alerts = window.falconryApp.birdDatabase.filter(bird => bird.status !== 'optimal');
            
            if (alerts.length === 0) {
                container.innerHTML = '<p class="text-gray-400 text-sm text-center">All birds healthy</p>';
                return;
            }
            
            alerts.forEach(bird => {
                const alertElement = document.createElement('div');
                alertElement.className = 'flex items-center space-x-3 p-3 bg-white bg-opacity-10 rounded-lg';
                
                const statusColor = bird.status === 'alert' ? 'text-red-400' : 'text-yellow-400';
                
                alertElement.innerHTML = `
                    <img src="${bird.image}" alt="${bird.name}" class="w-8 h-8 rounded-lg object-cover">
                    <div class="flex-1">
                        <p class="text-white text-sm font-medium">${bird.name}</p>
                        <p class="${statusColor} text-xs">
                            ${bird.status === 'alert' ? 'Weight critical' : 'Weight monitoring needed'}
                        </p>
                    </div>
                    <span class="text-gray-300 text-xs">${bird.weight}g</span>
                `;
                
                container.appendChild(alertElement);
            });
        }

        function initializeCharts() {
            initializeWeightTrendsChart();
            initializePerformanceChart();
            initializeTrainingTypeChart();
            initializeSuccessByTypeChart();
            initializeWeightPerformanceChart();
        }

        function initializeWeightTrendsChart() {
            const container = document.getElementById('weightTrendsChart');
            container.classList.add('fade-in-up');
            
            weightTrendsChart = echarts.init(container);
            
            // Sample weight data for multiple birds
            const dates = ['Nov 1', 'Nov 2', 'Nov 3', 'Nov 4', 'Nov 5', 'Nov 6', 'Nov 7', 'Nov 8'];
            const birdData = [
                { name: 'Horus', data: [975, 978, 982, 980, 983, 985, 982, 985] },
                { name: 'Odin', data: [1645, 1648, 1645, 1650, 1648, 1650, 1645, 1620] },
                { name: 'Freya', data: [1280, 1285, 1282, 1278, 1285, 1280, 1283, 1280] }
            ];
            
            const option = {
                backgroundColor: 'transparent',
                textStyle: { color: '#ffffff' },
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    borderColor: '#D4A574',
                    textStyle: { color: '#ffffff' }
                },
                legend: {
                    data: birdData.map(bird => bird.name),
                    textStyle: { color: '#ffffff' }
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: dates,
                    axisLine: { lineStyle: { color: '#6B7280' } },
                    axisLabel: { color: '#9CA3AF' }
                },
                yAxis: {
                    type: 'value',
                    axisLine: { lineStyle: { color: '#6B7280' } },
                    axisLabel: { color: '#9CA3AF' },
                    splitLine: { lineStyle: { color: 'rgba(255, 255, 255, 0.1)' } }
                },
                series: birdData.map((bird, index) => ({
                    name: bird.name,
                    type: 'line',
                    smooth: true,
                    data: bird.data,
                    lineStyle: { color: ['#7DD3FC', '#D4A574', '#10B981'][index] },
                    areaStyle: {
                        color: {
                            type: 'linear',
                            x: 0, y: 0, x2: 0, y2: 1,
                            colorStops: [
                                { offset: 0, color: [['rgba(125, 211, 252, 0.3)', 'rgba(212, 165, 116, 0.3)', 'rgba(16, 185, 129, 0.3)'][index]] },
                                { offset: 1, color: [['rgba(125, 211, 252, 0.1)', 'rgba(212, 165, 116, 0.1)', 'rgba(16, 185, 129, 0.1)'][index]] }
                            ]
                        }
                    }
                }))
            };
            
            weightTrendsChart.setOption(option);
        }

        function initializePerformanceChart() {
            const container = document.getElementById('performanceChart');
            container.classList.add('fade-in-up');
            
            performanceChart = echarts.init(container);
            
            const dates = ['Nov 1', 'Nov 2', 'Nov 3', 'Nov 4', 'Nov 5', 'Nov 6', 'Nov 7', 'Nov 8'];
            const successData = [85, 88, 92, 89, 94, 91, 96, 93];
            const consistencyData = [78, 82, 85, 88, 86, 89, 92, 90];
            
            const option = {
                backgroundColor: 'transparent',
                textStyle: { color: '#ffffff' },
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    borderColor: '#D4A574',
                    textStyle: { color: '#ffffff' }
                },
                legend: {
                    data: ['Training Success', 'Performance Consistency'],
                    textStyle: { color: '#ffffff' }
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: dates,
                    axisLine: { lineStyle: { color: '#6B7280' } },
                    axisLabel: { color: '#9CA3AF' }
                },
                yAxis: {
                    type: 'value',
                    axisLine: { lineStyle: { color: '#6B7280' } },
                    axisLabel: { color: '#9CA3AF' },
                    splitLine: { lineStyle: { color: 'rgba(255, 255, 255, 0.1)' } }
                },
                series: [
                    {
                        name: 'Training Success',
                        type: 'line',
                        smooth: true,
                        data: successData,
                        lineStyle: { color: '#7DD3FC' },
                        areaStyle: {
                            color: {
                                type: 'linear',
                                x: 0, y: 0, x2: 0, y2: 1,
                                colorStops: [
                                    { offset: 0, color: 'rgba(125, 211, 252, 0.3)' },
                                    { offset: 1, color: 'rgba(125, 211, 252, 0.1)' }
                                ]
                            }
                        }
                    },
                    {
                        name: 'Performance Consistency',
                        type: 'line',
                        smooth: true,
                        data: consistencyData,
                        lineStyle: { color: '#D4A574' },
                        areaStyle: {
                            color: {
                                type: 'linear',
                                x: 0, y: 0, x2: 0, y2: 1,
                                colorStops: [
                                    { offset: 0, color: 'rgba(212, 165, 116, 0.3)' },
                                    { offset: 1, color: 'rgba(212, 165, 116, 0.1)' }
                                ]
                            }
                        }
                    }
                ]
            };
            
            performanceChart.setOption(option);
        }

        function initializeTrainingTypeChart() {
            const container = document.getElementById('trainingTypeChart');
            container.classList.add('fade-in-up');
            
            trainingTypeChart = echarts.init(container);
            
            const data = [
                { value: 35, name: 'Flight Training' },
                { value: 25, name: 'Lure Training' },
                { value: 20, name: 'Recall Training' },
                { value: 12, name: 'Hunting Simulation' },
                { value: 8, name: 'Weathering' }
            ];
            
            const option = {
                backgroundColor: 'transparent',
                textStyle: { color: '#ffffff' },
                tooltip: {
                    trigger: 'item',
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    borderColor: '#D4A574',
                    textStyle: { color: '#ffffff' }
                },
                legend: {
                    orient: 'vertical',
                    left: 'left',
                    textStyle: { color: '#ffffff' }
                },
                series: [
                    {
                        name: 'Training Types',
                        type: 'pie',
                        radius: '50%',
                        data: data,
                        emphasis: {
                            itemStyle: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        },
                        itemStyle: {
                            color: function(params) {
                                const colors = ['#7DD3FC', '#D4A574', '#10B981', '#EF4444', '#8B5CF6'];
                                return colors[params.dataIndex];
                            }
                        }
                    }
                ]
            };
            
            trainingTypeChart.setOption(option);
        }

        function initializeSuccessByTypeChart() {
            const container = document.getElementById('successByTypeChart');
            container.classList.add('fade-in-up');
            
            successByTypeChart = echarts.init(container);
            
            const option = {
                backgroundColor: 'transparent',
                textStyle: { color: '#ffffff' },
                tooltip: {
                    trigger: 'axis',
                    axisPointer: { type: 'shadow' },
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    borderColor: '#D4A574',
                    textStyle: { color: '#ffffff' }
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: ['Flight', 'Lure', 'Recall', 'Hunting', 'Weathering'],
                    axisLine: { lineStyle: { color: '#6B7280' } },
                    axisLabel: { color: '#9CA3AF' }
                },
                yAxis: {
                    type: 'value',
                    axisLine: { lineStyle: { color: '#6B7280' } },
                    axisLabel: { color: '#9CA3AF' },
                    splitLine: { lineStyle: { color: 'rgba(255, 255, 255, 0.1)' } }
                },
                series: [
                    {
                        name: 'Success Rate',
                        type: 'bar',
                        data: [92, 88, 95, 82, 97],
                        itemStyle: {
                            color: {
                                type: 'linear',
                                x: 0, y: 0, x2: 0, y2: 1,
                                colorStops: [
                                    { offset: 0, color: '#7DD3FC' },
                                    { offset: 1, color: '#3B82F6' }
                                ]
                            }
                        }
                    }
                ]
            };
            
            successByTypeChart.setOption(option);
        }

        function initializeWeightPerformanceChart() {
            const container = document.getElementById('weightPerformanceChart');
            container.classList.add('fade-in-up');
            
            weightPerformanceChart = echarts.init(container);
            
            const option = {
                backgroundColor: 'transparent',
                textStyle: { color: '#ffffff' },
                tooltip: {
                    trigger: 'item',
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    borderColor: '#D4A574',
                    textStyle: { color: '#ffffff' }
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'value',
                    name: 'Weight (g)',
                    axisLine: { lineStyle: { color: '#6B7280' } },
                    axisLabel: { color: '#9CA3AF' },
                    splitLine: { lineStyle: { color: 'rgba(255, 255, 255, 0.1)' } }
                },
                yAxis: {
                    type: 'value',
                    name: 'Success Rate (%)',
                    axisLine: { lineStyle: { color: '#6B7280' } },
                    axisLabel: { color: '#9CA3AF' },
                    splitLine: { lineStyle: { color: 'rgba(255, 255, 255, 0.1)' } }
                },
                series: [
                    {
                        name: 'Weight vs Performance',
                        type: 'scatter',
                        data: [
                            [985, 95], [1620, 88], [1280, 82], [4200, 93],
                            [995, 92], [1640, 90], [1290, 89], [4250, 85]
                        ],
                        symbolSize: 8,
                        itemStyle: {
                            color: '#D4A574'
                        }
                    }
                ]
            };
            
            weightPerformanceChart.setOption(option);
        }

        function setupEventListeners() {
            document.getElementById('compareBirdsBtn').onclick = compareSelectedBirds;
            document.getElementById('performanceBirdSelect').onchange = updatePerformanceChart;
            
            // Time range buttons
            document.getElementById('weightTimeRange7').onclick = () => updateWeightTrends(7);
            document.getElementById('weightTimeRange30').onclick = () => updateWeightTrends(30);
            document.getElementById('weightTimeRange90').onclick = () => updateWeightTrends(90);
            
            // Export buttons
            document.querySelectorAll('.export-btn').forEach(btn => {
                btn.onclick = () => window.falconryApp.showNotification('Export feature coming soon!', 'info');
            });
        }

        function compareSelectedBirds() {
            if (selectedBirdsForComparison.length < 2) {
                window.falconryApp.showNotification('Please select at least 2 birds for comparison', 'error');
                return;
            }
            
            // Create comparison modal or redirect to comparison view
            window.falconryApp.showNotification(`Comparing ${selectedBirdsForComparison.map(b => b.name).join(', ')}`, 'success');
        }

        function updatePerformanceChart() {
            // Update performance chart based on selected bird
            const selectedBirdId = document.getElementById('performanceBirdSelect').value;
            window.falconryApp.showNotification(`Updated performance chart for ${selectedBirdId === 'all' ? 'all birds' : 'selected bird'}`, 'info');
        }

        function updateWeightTrends(days) {
            // Update weight trends chart time range
            document.querySelectorAll('[id^="weightTimeRange"]').forEach(btn => {
                btn.className = 'px-3 py-1 text-sm bg-gray-600 text-white rounded-lg';
            });
            document.getElementById(`weightTimeRange${days}`).className = 'px-3 py-1 text-sm bg-amber-600 text-white rounded-lg';
            
            window.falconryApp.showNotification(`Updated weight trends to ${days} days`, 'info');
        }

        function animateOnLoad() {
            anime({
                targets: '.metric-card',
                opacity: [0, 1],
                translateY: [30, 0],
                delay: anime.stagger(100),
                duration: 600,
                easing: 'easeOutQuart'
            });
            
            anime({
                targets: '.glass-card',
                opacity: [0, 1],
                translateY: [30, 0],
                delay: anime.stagger(100, {start: 300}),
                duration: 600,
                easing: 'easeOutQuart'
            });
        }

        // Make charts responsive
        window.addEventListener('resize', () => {
            if (weightTrendsChart) weightTrendsChart.resize();
            if (performanceChart) performanceChart.resize();
            if (trainingTypeChart) trainingTypeChart.resize();
            if (successByTypeChart) successByTypeChart.resize();
            if (weightPerformanceChart) weightPerformanceChart.resize();
        });
    </script>
</body>
</html>