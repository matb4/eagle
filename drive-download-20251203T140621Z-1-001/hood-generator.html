<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hood Pattern Generator - FalconPro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:wght@400;600;700&family=Inter:wght@300;400;500;600;700&family=Cinzel:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --forest-green: #2D5016;
            --warm-amber: #D4A574;
            --stone-gray: #6B7280;
            --copper-brown: #B45309;
            --sky-blue: #7DD3FC;
            --alert-red: #EF4444;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--forest-green) 0%, #1a3009 50%, var(--forest-green) 100%);
            background-size: 400% 400%;
            animation: gradientShift 20s ease infinite;
            min-height: 100vh;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .nav-link {
            position: relative;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover {
            color: var(--warm-amber);
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--warm-amber);
            transition: width 0.3s ease;
        }
        
        .nav-link:hover::after {
            width: 100%;
        }
        
        .hood-canvas {
            border: 2px solid var(--warm-amber);
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        
        .measurement-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
        }
        
        .measurement-input:focus {
            border-color: var(--warm-amber);
            box-shadow: 0 0 0 2px rgba(212, 165, 116, 0.3);
        }
        
        .pattern-style-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .pattern-style-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        
        .pattern-style-card.selected {
            border: 2px solid var(--warm-amber);
            background: rgba(212, 165, 116, 0.2);
        }
        
        .tool-button {
            transition: all 0.3s ease;
        }
        
        .tool-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .tool-button.active {
            background: var(--warm-amber);
            color: white;
        }
        
        .size-preview {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .measurement-guide {
            background: linear-gradient(135deg, rgba(125, 211, 252, 0.1) 0%, rgba(212, 165, 116, 0.1) 100%);
            border: 1px solid rgba(125, 211, 252, 0.3);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 glass-card">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-amber-400 to-amber-600 rounded-lg flex items-center justify-center">
                        <span class="text-white font-bold text-lg">F</span>
                    </div>
                    <h1 class="text-xl font-bold text-white">FalconPro</h1>
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="index.html" class="nav-link text-white font-medium">Dashboard</a>
                    <a href="training.html" class="nav-link text-white font-medium">Training</a>
                    <a href="analytics.html" class="nav-link text-white font-medium">Analytics</a>
                    <a href="profiles.html" class="nav-link text-white font-medium">Profiles</a>
                    <a href="hood-generator.html" class="nav-link text-amber-400 font-medium">Hood Generator</a>
                </div>
                <div class="flex items-center space-x-3">
                    <img src="resources/falconer-portrait.jpg" alt="Falconer" class="w-8 h-8 rounded-full border-2 border-amber-400">
                    <span class="text-white text-sm hidden sm:block">Master Falconer</span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hood Generator Header -->
    <section class="pt-24 pb-8 px-4">
        <div class="max-w-7xl mx-auto">
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-white mb-4">Hood Pattern Generator</h1>
                <p class="text-gray-200 max-w-3xl mx-auto">
                    Create professional falconry hood patterns using the Slijper's Canon method. 
                    Generate custom patterns based on your bird's measurements for perfect fit.
                </p>
            </div>

            <!-- Quick Stats -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="glass-card rounded-xl p-6 text-center">
                    <div class="text-3xl font-bold text-blue-400 mb-2">Slijper</div>
                    <div class="text-gray-200 text-sm">Canon Method</div>
                </div>
                <div class="glass-card rounded-xl p-6 text-center">
                    <div class="text-3xl font-bold text-amber-400 mb-2">¬±0.5mm</div>
                    <div class="text-gray-200 text-sm">Precision</div>
                </div>
                <div class="glass-card rounded-xl p-6 text-center">
                    <div class="text-3xl font-bold text-green-400 mb-2">5</div>
                    <div class="text-gray-200 text-sm">Pattern Styles</div>
                </div>
                <div class="glass-card rounded-xl p-6 text-center">
                    <div class="text-3xl font-bold text-purple-400 mb-2">‚àû</div>
                    <div class="text-gray-200 text-sm">Customizations</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Hood Generator Interface -->
    <section class="px-4 pb-12">
        <div class="max-w-7xl mx-auto">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                
                <!-- Measurement Input Panel -->
                <div class="lg:col-span-1">
                    <div class="glass-card rounded-xl p-6 mb-6">
                        <h2 class="text-xl font-semibold text-white mb-6">Bird Measurements</h2>
                        
                        <!-- Measurement Guide -->
                        <div class="measurement-guide rounded-lg p-4 mb-6">
                            <h3 class="text-lg font-semibold text-white mb-3">üìè Measurement Guide</h3>
                            <div class="text-gray-200 text-sm space-y-2">
                                <p><strong>Eye Distance:</strong> Measure between the widest points of the eyes (in mm)</p>
                                <p><strong>Beak Length:</strong> From cere to tip (optional, for custom fit)</p>
                                <p><strong>Head Width:</strong> Widest point behind the eyes (optional)</p>
                            </div>
                        </div>
                        
                        <!-- Measurement Inputs -->
                        <div class="space-y-4">
                            <div>
                                <label class="block text-gray-200 mb-2">Eye Distance (mm) *</label>
                                <input type="number" id="eyeDistance" class="measurement-input w-full px-3 py-2 rounded-lg" 
                                       placeholder="Enter measurement" min="30" max="100" step="0.5">
                                <p class="text-gray-400 text-xs mt-1">Primary measurement for hood size</p>
                            </div>
                            
                            <div>
                                <label class="block text-gray-200 mb-2">Bird Species</label>
                                <select id="birdSpecies" class="measurement-input w-full px-3 py-2 rounded-lg">
                                    <option value="">Select species (optional)</option>
                                    <option value="Peregrine Falcon">Peregrine Falcon</option>
                                    <option value="Red-tailed Hawk">Red-tailed Hawk</option>
                                    <option value="Golden Eagle">Golden Eagle</option>
                                    <option value="Harris's Hawk">Harris's Hawk</option>
                                    <option value="Gyrfalcon">Gyrfalcon</option>
                                    <option value="American Kestrel">American Kestrel</option>
                                    <option value="Merlin">Merlin</option>
                                    <option value="Cooper's Hawk">Cooper's Hawk</option>
                                    <option value="Goshawk">Goshawk</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-gray-200 mb-2">Bird Weight (g)</label>
                                <input type="number" id="birdWeight" class="measurement-input w-full px-3 py-2 rounded-lg" 
                                       placeholder="Enter weight" min="100" max="8000">
                                <p class="text-gray-400 text-xs mt-1">For size verification</p>
                            </div>
                            
                            <div>
                                <label class="block text-gray-200 mb-2">Beak Length (mm)</label>
                                <input type="number" id="beakLength" class="measurement-input w-full px-3 py-2 rounded-lg" 
                                       placeholder="Optional" min="10" max="50" step="0.5">
                            </div>
                            
                            <div>
                                <label class="block text-gray-200 mb-2">Head Width (mm)</label>
                                <input type="number" id="headWidth" class="measurement-input w-full px-3 py-2 rounded-lg" 
                                       placeholder="Optional" min="20" max="80" step="0.5">
                            </div>
                        </div>
                        
                        <!-- Pattern Style Selection -->
                        <div class="mt-6">
                            <h3 class="text-lg font-semibold text-white mb-4">Pattern Style</h3>
                            <div class="grid grid-cols-1 gap-3">
                                <div class="pattern-style-card glass-card rounded-lg p-3 selected" data-style="slijper">
                                    <h4 class="text-white font-medium mb-1">Slijper's Canon</h4>
                                    <p class="text-gray-300 text-sm">Traditional Dutch method</p>
                                </div>
                                <div class="pattern-style-card glass-card rounded-lg p-3" data-style="indian">
                                    <h4 class="text-white font-medium mb-1">Indian Style</h4>
                                    <p class="text-gray-300 text-sm">Straight-line construction</p>
                                </div>
                                <div class="pattern-style-card glass-card rounded-lg p-3" data-style="arab">
                                    <h4 class="text-white font-medium mb-1">Arab Style</h4>
                                    <p class="text-gray-300 text-sm">Circular pattern design</p>
                                </div>
                                <div class="pattern-style-card glass-card rounded-lg p-3" data-style="modern">
                                    <h4 class="text-white font-medium mb-1">Modern Hybrid</h4>
                                    <p class="text-gray-300 text-sm">Combined features</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Generate Button -->
                        <button id="generatePattern" class="w-full mt-6 bg-amber-600 hover:bg-amber-700 text-white py-3 px-4 rounded-lg transition-colors font-semibold">
                            Generate Pattern
                        </button>
                    </div>
                    
                    <!-- Size Recommendations -->
                    <div class="glass-card rounded-xl p-6">
                        <h3 class="text-lg font-semibold text-white mb-4">Size Recommendations</h3>
                        <div id="sizeRecommendations" class="space-y-3">
                            <p class="text-gray-300 text-sm">Enter measurements to see recommendations</p>
                        </div>
                    </div>
                </div>

                <!-- Pattern Canvas and Tools -->
                <div class="lg:col-span-2">
                    
                    <!-- Design Tools -->
                    <div class="glass-card rounded-xl p-6 mb-6">
                        <h2 class="text-xl font-semibold text-white mb-4">Design Tools</h2>
                        <div class="flex flex-wrap gap-3 mb-4">
                            <button class="tool-button active bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg" data-tool="select">
                                üîç Select
                            </button>
                            <button class="tool-button bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg" data-tool="edit">
                                ‚úèÔ∏è Edit Points
                            </button>
                            <button class="tool-button bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg" data-tool="add">
                                ‚ûï Add Points
                            </button>
                            <button class="tool-button bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg" data-tool="delete">
                                üóëÔ∏è Delete
                            </button>
                            <button class="tool-button bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg" data-tool="measure">
                                üìè Measure
                            </button>
                        </div>
                        
                        <!-- Tool Options -->
                        <div id="toolOptions" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-gray-200 mb-2">Line Width (mm)</label>
                                <input type="range" id="lineWidth" min="0.5" max="3" step="0.1" value="1" 
                                       class="w-full h-2 bg-gray-600 rounded-lg appearance-none cursor-pointer">
                                <span id="lineWidthValue" class="text-gray-300 text-sm">1.0mm</span>
                            </div>
                            <div>
                                <label class="block text-gray-200 mb-2">Seam Allowance (mm)</label>
                                <input type="range" id="seamAllowance" min="3" max="10" step="0.5" value="5" 
                                       class="w-full h-2 bg-gray-600 rounded-lg appearance-none cursor-pointer">
                                <span id="seamAllowanceValue" class="text-gray-300 text-sm">5.0mm</span>
                            </div>
                            <div>
                                <label class="block text-gray-200 mb-2">Pattern Scale (%)</label>
                                <input type="range" id="patternScale" min="80" max="120" step="1" value="100" 
                                       class="w-full h-2 bg-gray-600 rounded-lg appearance-none cursor-pointer">
                                <span id="patternScaleValue" class="text-gray-300 text-sm">100%</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Pattern Canvas -->
                    <div class="glass-card rounded-xl p-6 mb-6">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-xl font-semibold text-white">Pattern Canvas</h2>
                            <div class="flex space-x-2">
                                <button id="zoomIn" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded-lg text-sm">
                                    üîç+
                                </button>
                                <button id="zoomOut" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded-lg text-sm">
                                    üîç-
                                </button>
                                <button id="resetView" class="bg-gray-600 hover:bg-gray-700 text-white px-3 py-1 rounded-lg text-sm">
                                    Reset
                                </button>
                            </div>
                        </div>
                        
                        <div class="relative bg-white rounded-lg p-4 overflow-auto" style="height: 500px;">
                            <canvas id="hoodCanvas" class="hood-canvas border border-gray-300 rounded-lg" 
                                    width="600" height="400"></canvas>
                        </div>
                        
                        <!-- Canvas Info -->
                        <div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                            <div class="text-center">
                                <span class="text-gray-300">Canvas Size:</span>
                                <span id="canvasSize" class="text-white font-medium ml-2">600√ó400mm</span>
                            </div>
                            <div class="text-center">
                                <span class="text-gray-300">Zoom Level:</span>
                                <span id="zoomLevel" class="text-white font-medium ml-2">100%</span>
                            </div>
                            <div class="text-center">
                                <span class="text-gray-300">Pattern Size:</span>
                                <span id="patternSize" class="text-white font-medium ml-2">-</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Pattern Information -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        
                        <!-- Pattern Details -->
                        <div class="glass-card rounded-lg p-4">
                            <h3 class="text-lg font-semibold text-white mb-4">Pattern Details</h3>
                            <div id="patternDetails" class="space-y-2 text-sm">
                                <div class="flex justify-between">
                                    <span class="text-gray-300">Hood Size:</span>
                                    <span id="hoodSize" class="text-white font-medium">-</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-300">Eye Distance:</span>
                                    <span id="patternEyeDistance" class="text-white font-medium">-</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-300">Beak Opening:</span>
                                    <span id="beakOpening" class="text-white font-medium">-</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-300">Back Width:</span>
                                    <span id="backWidth" class="text-white font-medium">-</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-300">Total Length:</span>
                                    <span id="totalLength" class="text-white font-medium">-</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Cutting Instructions -->
                        <div class="glass-card rounded-lg p-4">
                            <h3 class="text-lg font-semibold text-white mb-4">Cutting Instructions</h3>
                            <div id="cuttingInstructions" class="space-y-3 text-sm text-gray-200">
                                <p>1. Print pattern on heavy cardstock</p>
                                <p>2. Cut out pattern carefully with exacto knife</p>
                                <p>3. Transfer to 2-3oz vegetable-tanned leather</p>
                                <p>4. Cut brace slits 1.5mm apart, 10mm long</p>
                                <p>5. Cut top knot slits 1.5mm apart, 10mm long</p>
                                <p>6. Sew with dental floss or waxed thread</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Export Options -->
                    <div class="glass-card rounded-lg p-4 mt-6">
                        <h3 class="text-lg font-semibold text-white mb-4">Export Pattern</h3>
                        <div class="flex flex-wrap gap-3">
                            <button id="exportPDF" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors">
                                üìÑ Export PDF
                            </button>
                            <button id="exportSVG" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors">
                                üé® Export SVG
                            </button>
                            <button id="exportPNG" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">
                                üñºÔ∏è Export PNG
                            </button>
                            <button id="printPattern" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors">
                                üñ®Ô∏è Print Pattern
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Hood Pattern Library -->
    <section class="px-4 pb-12">
        <div class="max-w-7xl mx-auto">
            <div class="glass-card rounded-xl p-6">
                <h2 class="text-xl font-semibold text-white mb-6">Hood Pattern Library</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="patternLibrary">
                    <!-- Pattern library items will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </section>

    <script>
        // Hood Pattern Generator Application
        class HoodPatternGenerator {
            constructor() {
                this.canvas = document.getElementById('hoodCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.currentTool = 'select';
                this.currentStyle = 'slijper';
                this.patternData = null;
                this.zoomLevel = 1;
                this.selectedPoints = [];
                this.isDragging = false;
                this.dragOffset = { x: 0, y: 0 };
                
                this.initializeCanvas();
                this.setupEventListeners();
                this.loadPatternLibrary();
            }
            
            initializeCanvas() {
                // Set canvas dimensions
                this.canvas.width = 600;
                this.canvas.height = 400;
                
                // Set initial canvas properties
                this.ctx.lineWidth = 1;
                this.ctx.strokeStyle = '#2D5016';
                this.ctx.fillStyle = '#F5F5DC';
                
                // Clear canvas
                this.clearCanvas();
            }
            
            setupEventListeners() {
                // Measurement inputs
                document.getElementById('eyeDistance').addEventListener('input', this.updateSizeRecommendations.bind(this));
                document.getElementById('birdSpecies').addEventListener('change', this.updateSizeRecommendations.bind(this));
                document.getElementById('birdWeight').addEventListener('input', this.updateSizeRecommendations.bind(this));
                
                // Pattern style selection
                document.querySelectorAll('.pattern-style-card').forEach(card => {
                    card.addEventListener('click', this.selectPatternStyle.bind(this));
                });
                
                // Generate pattern button
                document.getElementById('generatePattern').addEventListener('click', this.generatePattern.bind(this));
                
                // Tool selection
                document.querySelectorAll('.tool-button').forEach(btn => {
                    btn.addEventListener('click', this.selectTool.bind(this));
                });
                
                // Tool options
                document.getElementById('lineWidth').addEventListener('input', this.updateLineWidth.bind(this));
                document.getElementById('seamAllowance').addEventListener('input', this.updateSeamAllowance.bind(this));
                document.getElementById('patternScale').addEventListener('input', this.updatePatternScale.bind(this));
                
                // Canvas controls
                document.getElementById('zoomIn').addEventListener('click', this.zoomIn.bind(this));
                document.getElementById('zoomOut').addEventListener('click', this.zoomOut.bind(this));
                document.getElementById('resetView').addEventListener('click', this.resetView.bind(this));
                
                // Export buttons
                document.getElementById('exportPDF').addEventListener('click', this.exportPDF.bind(this));
                document.getElementById('exportSVG').addEventListener('click', this.exportSVG.bind(this));
                document.getElementById('exportPNG').addEventListener('click', this.exportPNG.bind(this));
                document.getElementById('printPattern').addEventListener('click', this.printPattern.bind(this));
                
                // Canvas events
                this.canvas.addEventListener('mousedown', this.handleCanvasMouseDown.bind(this));
                this.canvas.addEventListener('mousemove', this.handleCanvasMouseMove.bind(this));
                this.canvas.addEventListener('mouseup', this.handleCanvasMouseUp.bind(this));
                this.canvas.addEventListener('wheel', this.handleCanvasWheel.bind(this));
            }
            
            updateSizeRecommendations() {
                const eyeDistance = parseFloat(document.getElementById('eyeDistance').value);
                const species = document.getElementById('birdSpecies').value;
                const weight = parseFloat(document.getElementById('birdWeight').value);
                
                const container = document.getElementById('sizeRecommendations');
                container.innerHTML = '';
                
                if (!eyeDistance) {
                    container.innerHTML = '<p class="text-gray-300 text-sm">Enter eye distance for recommendations</p>';
                    return;
                }
                
                // Size recommendations based on research
                const recommendations = this.getSizeRecommendations(eyeDistance, species, weight);
                
                recommendations.forEach(rec => {
                    const item = document.createElement('div');
                    item.className = 'flex justify-between items-center p-2 bg-white bg-opacity-10 rounded-lg';
                    item.innerHTML = `
                        <div>
                            <p class="text-white font-medium">${rec.type}</p>
                            <p class="text-gray-300 text-xs">${rec.description}</p>
                        </div>
                        <span class="text-amber-400 font-bold">${rec.size}mm</span>
                    `;
                    container.appendChild(item);
                });
            }
            
            getSizeRecommendations(eyeDistance, species, weight) {
                const recommendations = [];
                
                // Primary recommendation based on eye distance
                recommendations.push({
                    type: 'Recommended Size',
                    description: 'Based on eye distance measurement',
                    size: Math.round(eyeDistance)
                });
                
                // Species-specific adjustments
                if (species) {
                    const speciesAdjustments = {
                        'Peregrine Falcon': { male: -2, female: 2 },
                        'Red-tailed Hawk': { male: 3, female: 6 },
                        'Golden Eagle': { male: 15, female: 20 },
                        'Harris\'s Hawk': { male: 2, female: 5 },
                        'Gyrfalcon': { male: 4, female: 8 },
                        'American Kestrel': { male: -5, female: -3 },
                        'Merlin': { male: -3, female: 0 },
                        'Cooper\'s Hawk': { male: 0, female: 3 },
                        'Goshawk': { male: 5, female: 10 }
                    };
                    
                    if (speciesAdjustments[species]) {
                        const adj = speciesAdjustments[species];
                        recommendations.push({
                            type: 'Male Adjustment',
                            description: `${species} male`,
                            size: Math.round(eyeDistance + adj.male)
                        });
                        recommendations.push({
                            type: 'Female Adjustment',
                            description: `${species} female`,
                            size: Math.round(eyeDistance + adj.female)
                        });
                    }
                }
                
                // Weight-based verification
                if (weight) {
                    const weightBasedSize = this.estimateSizeFromWeight(weight, species);
                    if (weightBasedSize) {
                        recommendations.push({
                            type: 'Weight Verification',
                            description: 'Estimated from weight',
                            size: weightBasedSize
                        });
                    }
                }
                
                return recommendations;
            }
            
            estimateSizeFromWeight(weight, species) {
                // Rough estimation based on weight ranges
                if (weight < 200) return 35; // Kestrel, small merlin
                if (weight < 400) return 40; // Merlin, small hawk
                if (weight < 800) return 45; // Small falcon, hawk
                if (weight < 1200) return 50; // Medium falcon, hawk
                if (weight < 2000) return 55; // Large hawk, small eagle
                if (weight < 4000) return 65; // Eagle
                return 75; // Large eagle
            }
            
            selectPatternStyle(event) {
                document.querySelectorAll('.pattern-style-card').forEach(card => {
                    card.classList.remove('selected');
                });
                
                event.currentTarget.classList.add('selected');
                this.currentStyle = event.currentTarget.dataset.style;
            }
            
            generatePattern() {
                const eyeDistance = parseFloat(document.getElementById('eyeDistance').value);
                
                if (!eyeDistance) {
                    window.falconryApp.showNotification('Please enter eye distance measurement', 'error');
                    return;
                }
                
                // Generate pattern based on selected style
                this.patternData = this.createPatternData(eyeDistance, this.currentStyle);
                
                // Draw pattern on canvas
                this.drawPattern();
                
                // Update pattern information
                this.updatePatternInfo();
                
                window.falconryApp.showNotification('Pattern generated successfully!', 'success');
            }
            
            createPatternData(eyeDistance, style) {
                const baseSize = eyeDistance;
                const scale = parseFloat(document.getElementById('patternScale').value) / 100;
                
                // Different pattern calculations based on style
                switch (style) {
                    case 'slijper':
                        return this.createSlijperPattern(baseSize, scale);
                    case 'indian':
                        return this.createIndianPattern(baseSize, scale);
                    case 'arab':
                        return this.createArabPattern(baseSize, scale);
                    case 'modern':
                        return this.createModernPattern(baseSize, scale);
                    default:
                        return this.createSlijperPattern(baseSize, scale);
                }
            }
            
            createSlijperPattern(baseSize, scale) {
                const size = baseSize * scale;
                const centerX = this.canvas.width / 2;
                const centerY = this.canvas.height / 2;
                
                // Slijper's Canon pattern calculations
                const eyeDistance = size;
                const beakWidth = size * 0.3;
                const backWidth = size * 0.8;
                const totalLength = size * 1.2;
                const beakLength = size * 0.4;
                
                // Create pattern points
                const points = [
                    // Beak opening (top)
                    { x: centerX - beakWidth/2, y: centerY - totalLength/2, type: 'beak' },
                    { x: centerX + beakWidth/2, y: centerY - totalLength/2, type: 'beak' },
                    
                    // Eye areas (left and right)
                    { x: centerX - eyeDistance/2 - 5, y: centerY - totalLength/4, type: 'eye' },
                    { x: centerX - eyeDistance/2 + 5, y: centerY - totalLength/4, type: 'eye' },
                    { x: centerX + eyeDistance/2 - 5, y: centerY - totalLength/4, type: 'eye' },
                    { x: centerX + eyeDistance/2 + 5, y: centerY - totalLength/4, type: 'eye' },
                    
                    // Back of hood
                    { x: centerX - backWidth/2, y: centerY + totalLength/3, type: 'back' },
                    { x: centerX + backWidth/2, y: centerY + totalLength/3, type: 'back' },
                    
                    // Bottom points
                    { x: centerX - beakWidth/2, y: centerY + totalLength/2, type: 'bottom' },
                    { x: centerX + beakWidth/2, y: centerY + totalLength/2, type: 'bottom' }
                ];
                
                return {
                    style: 'slijper',
                    size: baseSize,
                    scale: scale,
                    points: points,
                    eyeDistance: eyeDistance,
                    beakWidth: beakWidth,
                    backWidth: backWidth,
                    totalLength: totalLength,
                    beakLength: beakLength
                };
            }
            
            createIndianPattern(baseSize, scale) {
                const size = baseSize * scale;
                const centerX = this.canvas.width / 2;
                const centerY = this.canvas.height / 2;
                
                // Indian style pattern - straight lines
                const eyeDistance = size;
                const height = size * 1.1;
                const width = size * 0.9;
                
                const points = [
                    // Top points
                    { x: centerX - width/2, y: centerY - height/2, type: 'top' },
                    { x: centerX + width/2, y: centerY - height/2, type: 'top' },
                    
                    // Eye points
                    { x: centerX - eyeDistance/2, y: centerY - height/4, type: 'eye' },
                    { x: centerX + eyeDistance/2, y: centerY - height/4, type: 'eye' },
                    
                    // Side points
                    { x: centerX - width/2, y: centerY + height/4, type: 'side' },
                    { x: centerX + width/2, y: centerY + height/4, type: 'side' },
                    
                    // Bottom points
                    { x: centerX - width/3, y: centerY + height/2, type: 'bottom' },
                    { x: centerX + width/3, y: centerY + height/2, type: 'bottom' }
                ];
                
                return {
                    style: 'indian',
                    size: baseSize,
                    scale: scale,
                    points: points,
                    eyeDistance: eyeDistance,
                    height: height,
                    width: width
                };
            }
            
            createArabPattern(baseSize, scale) {
                const size = baseSize * scale;
                const centerX = this.canvas.width / 2;
                const centerY = this.canvas.height / 2;
                
                // Arab style - circular elements
                const eyeDistance = size;
                const radius = size * 0.6;
                
                const points = [];
                const segments = 16;
                
                for (let i = 0; i < segments; i++) {
                    const angle = (i / segments) * 2 * Math.PI;
                    const x = centerX + Math.cos(angle) * radius;
                    const y = centerY + Math.sin(angle) * radius * 0.8;
                    points.push({ x, y, type: 'circle' });
                }
                
                // Add eye positions
                points.push({ x: centerX - eyeDistance/2, y: centerY - radius/3, type: 'eye' });
                points.push({ x: centerX + eyeDistance/2, y: centerY - radius/3, type: 'eye' });
                
                return {
                    style: 'arab',
                    size: baseSize,
                    scale: scale,
                    points: points,
                    eyeDistance: eyeDistance,
                    radius: radius
                };
            }
            
            createModernPattern(baseSize, scale) {
                const size = baseSize * scale;
                const centerX = this.canvas.width / 2;
                const centerY = this.canvas.height / 2;
                
                // Modern hybrid pattern
                const eyeDistance = size;
                const width = size * 0.85;
                const height = size * 1.15;
                
                const points = [
                    // Curved top
                    { x: centerX - width/2, y: centerY - height/2, type: 'curve' },
                    { x: centerX, y: centerY - height/2 - 5, type: 'curve' },
                    { x: centerX + width/2, y: centerY - height/2, type: 'curve' },
                    
                    // Eye areas with ergonomic curves
                    { x: centerX - eyeDistance/2 - 3, y: centerY - height/4, type: 'eye' },
                    { x: centerX - eyeDistance/2 + 3, y: centerY - height/4, type: 'eye' },
                    { x: centerX + eyeDistance/2 - 3, y: centerY - height/4, type: 'eye' },
                    { x: centerX + eyeDistance/2 + 3, y: centerY - height/4, type: 'eye' },
                    
                    // Contoured back
                    { x: centerX - width/2 + 5, y: centerY + height/3, type: 'back' },
                    { x: centerX + width/2 - 5, y: centerY + height/3, type: 'back' },
                    
                    // Ergonomic bottom
                    { x: centerX - width/3, y: centerY + height/2, type: 'bottom' },
                    { x: centerX + width/3, y: centerY + height/2, type: 'bottom' }
                ];
                
                return {
                    style: 'modern',
                    size: baseSize,
                    scale: scale,
                    points: points,
                    eyeDistance: eyeDistance,
                    width: width,
                    height: height
                };
            }
            
            drawPattern() {
                if (!this.patternData) return;
                
                this.clearCanvas();
                
                // Apply transformations
                this.ctx.save();
                this.ctx.scale(this.zoomLevel, this.zoomLevel);
                
                // Draw pattern based on style
                switch (this.patternData.style) {
                    case 'slijper':
                        this.drawSlijperPattern();
                        break;
                    case 'indian':
                        this.drawIndianPattern();
                        break;
                    case 'arab':
                        this.drawArabPattern();
                        break;
                    case 'modern':
                        this.drawModernPattern();
                        break;
                }
                
                this.ctx.restore();
            }
            
            drawSlijperPattern() {
                const points = this.patternData.points;
                
                // Main hood outline
                this.ctx.beginPath();
                this.ctx.moveTo(points[0].x, points[0].y); // Start at beak
                
                // Draw beak opening
                this.ctx.lineTo(points[1].x, points[1].y);
                
                // Draw around eye areas
                this.ctx.lineTo(points[4].x, points[4].y);
                this.ctx.lineTo(points[5].x, points[5].y);
                this.ctx.lineTo(points[6].x, points[6].y);
                this.ctx.lineTo(points[7].x, points[7].y);
                
                // Draw back
                this.ctx.lineTo(points[2].x, points[2].y);
                this.ctx.lineTo(points[3].x, points[3].y);
                
                // Draw bottom
                this.ctx.lineTo(points[8].x, points[8].y);
                this.ctx.lineTo(points[0].x, points[0].y);
                
                this.ctx.strokeStyle = '#2D5016';
                this.ctx.lineWidth = parseFloat(document.getElementById('lineWidth').value);
                this.ctx.stroke();
                
                // Draw brace slits
                this.drawBraceSlits();
                
                // Draw top knot slits
                this.drawTopKnotSlits();
                
                // Add measurement annotations
                this.addMeasurementAnnotations();
            }
            
            drawIndianPattern() {
                const points = this.patternData.points;
                
                this.ctx.beginPath();
                this.ctx.moveTo(points[0].x, points[0].y);
                
                // Straight lines for Indian style
                points.forEach((point, index) => {
                    if (index > 0) {
                        this.ctx.lineTo(point.x, point.y);
                    }
                });
                
                this.ctx.closePath();
                this.ctx.strokeStyle = '#2D5016';
                this.ctx.lineWidth = parseFloat(document.getElementById('lineWidth').value);
                this.ctx.stroke();
                
                // Draw construction lines
                this.drawConstructionLines();
            }
            
            drawArabPattern() {
                const points = this.patternData.points;
                
                // Draw circular pattern
                this.ctx.beginPath();
                this.ctx.moveTo(points[0].x, points[0].y);
                
                for (let i = 1; i < points.length - 2; i++) {
                    this.ctx.lineTo(points[i].x, points[i].y);
                }
                
                this.ctx.closePath();
                this.ctx.strokeStyle = '#2D5016';
                this.ctx.lineWidth = parseFloat(document.getElementById('lineWidth').value);
                this.ctx.stroke();
                
                // Draw eye areas
                this.drawEyeAreas();
            }
            
            drawModernPattern() {
                const points = this.patternData.points;
                
                this.ctx.beginPath();
                this.ctx.moveTo(points[0].x, points[0].y);
                
                // Use curves for modern pattern
                points.forEach((point, index) => {
                    if (index > 0 && index < points.length - 1) {
                        const nextPoint = points[index + 1];
                        const controlX = (point.x + nextPoint.x) / 2;
                        const controlY = (point.y + nextPoint.y) / 2;
                        this.ctx.quadraticCurveTo(point.x, point.y, controlX, controlY);
                    }
                });
                
                this.ctx.closePath();
                this.ctx.strokeStyle = '#2D5016';
                this.ctx.lineWidth = parseFloat(document.getElementById('lineWidth').value);
                this.ctx.stroke();
                
                // Draw ergonomic features
                this.drawErgonomicFeatures();
            }
            
            drawBraceSlits() {
                const centerX = this.canvas.width / 2;
                const centerY = this.canvas.height / 2;
                const backY = centerY + this.patternData.totalLength / 3;
                
                // Left brace slits
                for (let i = 0; i < 3; i++) {
                    const x = centerX - this.patternData.backWidth/2 + i * 1.5;
                    this.ctx.beginPath();
                    this.ctx.moveTo(x, backY - 5);
                    this.ctx.lineTo(x, backY + 5);
                    this.ctx.strokeStyle = '#666';
                    this.ctx.lineWidth = 0.5;
                    this.ctx.stroke();
                }
                
                // Right brace slits
                for (let i = 0; i < 3; i++) {
                    const x = centerX + this.patternData.backWidth/2 - i * 1.5;
                    this.ctx.beginPath();
                    this.ctx.moveTo(x, backY - 5);
                    this.ctx.lineTo(x, backY + 5);
                    this.ctx.strokeStyle = '#666';
                    this.ctx.lineWidth = 0.5;
                    this.ctx.stroke();
                }
            }
            
            drawTopKnotSlits() {
                const centerX = this.canvas.width / 2;
                const centerY = this.canvas.height / 2;
                const topY = centerY - this.patternData.totalLength / 2 + 10;
                
                // Top knot slits
                for (let i = 0; i < 2; i++) {
                    const x = centerX - 1.5 + i * 3;
                    this.ctx.beginPath();
                    this.ctx.moveTo(x, topY - 5);
                    this.ctx.lineTo(x, topY + 5);
                    this.ctx.strokeStyle = '#666';
                    this.ctx.lineWidth = 0.5;
                    this.ctx.stroke();
                }
            }
            
            drawConstructionLines() {
                // Add construction lines for Indian pattern
                this.ctx.setLineDash([2, 2]);
                this.ctx.strokeStyle = '#999';
                this.ctx.lineWidth = 0.5;
                
                // Center lines
                const centerX = this.canvas.width / 2;
                const centerY = this.canvas.height / 2;
                
                this.ctx.beginPath();
                this.ctx.moveTo(centerX, centerY - 100);
                this.ctx.lineTo(centerX, centerY + 100);
                this.ctx.stroke();
                
                this.ctx.setLineDash([]);
            }
            
            drawEyeAreas() {
                const centerX = this.canvas.width / 2;
                const centerY = this.canvas.height / 2;
                
                // Draw eye area indicators
                this.ctx.beginPath();
                this.ctx.arc(centerX - this.patternData.eyeDistance/2, centerY - this.patternData.radius/3, 8, 0, 2 * Math.PI);
                this.ctx.strokeStyle = '#7DD3FC';
                this.ctx.lineWidth = 1;
                this.ctx.stroke();
                
                this.ctx.beginPath();
                this.ctx.arc(centerX + this.patternData.eyeDistance/2, centerY - this.patternData.radius/3, 8, 0, 2 * Math.PI);
                this.ctx.strokeStyle = '#7DD3FC';
                this.ctx.lineWidth = 1;
                this.ctx.stroke();
            }
            
            drawErgonomicFeatures() {
                // Add ergonomic curve indicators
                this.ctx.setLineDash([1, 1]);
                this.ctx.strokeStyle = '#D4A574';
                this.ctx.lineWidth = 0.5;
                
                // Draw ergonomic guides
                const points = this.patternData.points;
                for (let i = 0; i < points.length - 1; i++) {
                    const point = points[i];
                    const nextPoint = points[i + 1];
                    
                    this.ctx.beginPath();
                    this.ctx.moveTo(point.x, point.y);
                    this.ctx.lineTo(nextPoint.x, nextPoint.y);
                    this.ctx.stroke();
                }
                
                this.ctx.setLineDash([]);
            }
            
            addMeasurementAnnotations() {
                const centerX = this.canvas.width / 2;
                const centerY = this.canvas.height / 2;
                
                this.ctx.fillStyle = '#2D5016';
                this.ctx.font = '12px Arial';
                
                // Add measurement labels
                this.ctx.fillText(`${this.patternData.size}mm`, centerX - 20, centerY - this.patternData.totalLength/2 - 10);
                this.ctx.fillText('Eye Distance', centerX - 30, centerY - 20);
                this.ctx.fillText('Brace Slits', centerX - 25, centerY + this.patternData.totalLength/3 + 20);
            }
            
            updatePatternInfo() {
                if (!this.patternData) return;
                
                document.getElementById('hoodSize').textContent = `${this.patternData.size}mm`;
                document.getElementById('patternEyeDistance').textContent = `${this.patternData.eyeDistance.toFixed(1)}mm`;
                document.getElementById('beakOpening').textContent = `${(this.patternData.beakWidth || this.patternData.size * 0.3).toFixed(1)}mm`;
                document.getElementById('backWidth').textContent = `${(this.patternData.backWidth || this.patternData.size * 0.8).toFixed(1)}mm`;
                document.getElementById('totalLength').textContent = `${(this.patternData.totalLength || this.patternData.size * 1.2).toFixed(1)}mm`;
                document.getElementById('patternSize').textContent = `${this.patternData.size}mm`;
            }
            
            selectTool(event) {
                document.querySelectorAll('.tool-button').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                event.currentTarget.classList.add('active');
                this.currentTool = event.currentTarget.dataset.tool;
            }
            
            updateLineWidth(event) {
                const value = event.target.value;
                document.getElementById('lineWidthValue').textContent = `${value}mm`;
                this.redrawPattern();
            }
            
            updateSeamAllowance(event) {
                const value = event.target.value;
                document.getElementById('seamAllowanceValue').textContent = `${value}mm`;
                this.redrawPattern();
            }
            
            updatePatternScale(event) {
                const value = event.target.value;
                document.getElementById('patternScaleValue').textContent = `${value}%`;
                if (this.patternData) {
                    this.generatePattern();
                }
            }
            
            zoomIn() {
                this.zoomLevel = Math.min(this.zoomLevel * 1.2, 3);
                this.updateZoomDisplay();
                this.redrawPattern();
            }
            
            zoomOut() {
                this.zoomLevel = Math.max(this.zoomLevel / 1.2, 0.5);
                this.updateZoomDisplay();
                this.redrawPattern();
            }
            
            resetView() {
                this.zoomLevel = 1;
                this.updateZoomDisplay();
                this.redrawPattern();
            }
            
            updateZoomDisplay() {
                document.getElementById('zoomLevel').textContent = `${Math.round(this.zoomLevel * 100)}%`;
            }
            
            redrawPattern() {
                if (this.patternData) {
                    this.drawPattern();
                }
            }
            
            clearCanvas() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                
                // Draw grid background
                this.ctx.strokeStyle = '#f0f0f0';
                this.ctx.lineWidth = 0.5;
                
                // Vertical lines
                for (let x = 0; x < this.canvas.width; x += 10) {
                    this.ctx.beginPath();
                    this.ctx.moveTo(x, 0);
                    this.ctx.lineTo(x, this.canvas.height);
                    this.ctx.stroke();
                }
                
                // Horizontal lines
                for (let y = 0; y < this.canvas.height; y += 10) {
                    this.ctx.beginPath();
                    this.ctx.moveTo(0, y);
                    this.ctx.lineTo(this.canvas.width, y);
                    this.ctx.stroke();
                }
            }
            
            // Canvas event handlers
            handleCanvasMouseDown(event) {
                // Handle different tools
                switch (this.currentTool) {
                    case 'select':
                        this.handleSelectTool(event);
                        break;
                    case 'edit':
                        this.handleEditTool(event);
                        break;
                    case 'add':
                        this.handleAddTool(event);
                        break;
                    case 'delete':
                        this.handleDeleteTool(event);
                        break;
                    case 'measure':
                        this.handleMeasureTool(event);
                        break;
                }
            }
            
            handleCanvasMouseMove(event) {
                // Handle mouse move for dragging, etc.
            }
            
            handleCanvasMouseUp(event) {
                this.isDragging = false;
            }
            
            handleCanvasWheel(event) {
                event.preventDefault();
                
                if (event.deltaY < 0) {
                    this.zoomIn();
                } else {
                    this.zoomOut();
                }
            }
            
            handleSelectTool(event) {
                // Implementation for select tool
                window.falconryApp.showNotification('Select tool activated', 'info');
            }
            
            handleEditTool(event) {
                // Implementation for edit tool
                window.falconryApp.showNotification('Edit tool activated', 'info');
            }
            
            handleAddTool(event) {
                // Implementation for add tool
                window.falconryApp.showNotification('Add tool activated', 'info');
            }
            
            handleDeleteTool(event) {
                // Implementation for delete tool
                window.falconryApp.showNotification('Delete tool activated', 'info');
            }
            
            handleMeasureTool(event) {
                // Implementation for measure tool
                window.falconryApp.showNotification('Measure tool activated', 'info');
            }
            
            // Export functions
            exportPDF() {
                window.falconryApp.showNotification('PDF export feature coming soon!', 'info');
            }
            
            exportSVG() {
                window.falconryApp.showNotification('SVG export feature coming soon!', 'info');
            }
            
            exportPNG() {
                if (!this.patternData) {
                    window.falconryApp.showNotification('No pattern to export', 'error');
                    return;
                }
                
                const link = document.createElement('a');
                link.download = `hood-pattern-${this.patternData.size}mm.png`;
                link.href = this.canvas.toDataURL();
                link.click();
                
                window.falconryApp.showNotification('Pattern exported as PNG', 'success');
            }
            
            printPattern() {
                if (!this.patternData) {
                    window.falconryApp.showNotification('No pattern to print', 'error');
                    return;
                }
                
                const printWindow = window.open('', '_blank');
                printWindow.document.write(`
                    <html>
                        <head>
                            <title>Hood Pattern - ${this.patternData.size}mm</title>
                            <style>
                                body { margin: 0; padding: 20px; font-family: Arial, sans-serif; }
                                .pattern-container { text-align: center; }
                                .pattern-info { margin-bottom: 20px; }
                                canvas { border: 1px solid #000; max-width: 100%; height: auto; }
                                @media print {
                                    body { margin: 0; padding: 0; }
                                    .no-print { display: none; }
                                }
                            </style>
                        </head>
                        <body>
                            <div class="pattern-container">
                                <div class="pattern-info no-print">
                                    <h1>Hood Pattern - ${this.patternData.size}mm</h1>
                                    <p>Style: ${this.patternData.style}</p>
                                    <p>Eye Distance: ${this.patternData.eyeDistance}mm</p>
                                    <p>Print at 100% scale for accurate measurements</p>
                                </div>
                                <img src="${this.canvas.toDataURL()}" alt="Hood Pattern">
                                <div class="no-print">
                                    <p>Instructions:</p>
                                    <ol style="text-align: left; max-width: 600px; margin: 0 auto;">
                                        <li>Print this pattern on heavy cardstock</li>
                                        <li>Cut out carefully with exacto knife</li>
                                        <li>Transfer to 2-3oz vegetable-tanned leather</li>
                                        <li>Cut brace slits 1.5mm apart, 10mm long</li>
                                        <li>Cut top knot slits 1.5mm apart, 10mm long</li>
                                        <li>Sew with dental floss or waxed thread</li>
                                    </ol>
                                </div>
                            </div>
                        </body>
                    </html>
                `);
                
                printWindow.document.close();
                printWindow.print();
                
                window.falconryApp.showNotification('Print dialog opened', 'success');
            }
            
            loadPatternLibrary() {
                const library = [
                    { size: 35, species: 'American Kestrel', style: 'slijper', image: 'https://kimi-web-img.moonshot.cn/img/img.freepik.com/480299986719b53c5d2fe63743490d75a78df030.jpg' },
                    { size: 45, species: 'Peregrine Falcon', style: 'slijper', image: 'https://kimi-web-img.moonshot.cn/img/peregrinefund.org/a7861ad420818e701f485937c9904997b2c9712e.jpg' },
                    { size: 55, species: 'Red-tailed Hawk', style: 'indian', image: 'https://kimi-web-img.moonshot.cn/img/projectupland.com/375ea022575053dc481498954d703f23ef995409.jpg' },
                    { size: 65, species: 'Golden Eagle', style: 'arab', image: 'https://kimi-web-img.moonshot.cn/img/www.zachwildifeart.com/247bb6e05ad06bf6ef8e64fd88811f1099654dd2.jpg' },
                    { size: 50, species: 'Harris\'s Hawk', style: 'modern', image: 'https://kimi-web-img.moonshot.cn/img/royalcanadianfalconry.com/2f5918a2c745d6371b2ec8d081b1fc88db555034.jpg' },
                    { size: 60, species: 'Gyrfalcon', style: 'slijper', image: 'https://kimi-web-img.moonshot.cn/img/t3.ftcdn.net/4c15905e36b312ce927bf0c304e5a9e876d7bb5b.jpg' }
                ];
                
                const container = document.getElementById('patternLibrary');
                container.innerHTML = '';
                
                library.forEach(pattern => {
                    const item = document.createElement('div');
                    item.className = 'glass-card rounded-lg p-4 cursor-pointer hover:bg-white hover:bg-opacity-10 transition-all';
                    item.addEventListener('click', () => this.loadPattern(pattern));
                    
                    item.innerHTML = `
                        <div class="relative mb-3">
                            <img src="${pattern.image}" alt="${pattern.species}" class="w-full h-32 object-cover rounded-lg">
                            <div class="absolute top-2 right-2 bg-amber-600 text-white px-2 py-1 rounded text-xs font-bold">
                                ${pattern.size}mm
                            </div>
                        </div>
                        <h4 class="text-white font-medium mb-1">${pattern.species}</h4>
                        <p class="text-gray-300 text-sm mb-2">${pattern.style} style</p>
                        <div class="flex justify-between text-xs text-gray-400">
                            <span>Eye Distance: ${pattern.size}mm</span>
                            <span>Click to load</span>
                        </div>
                    `;
                    
                    container.appendChild(item);
                });
            }
            
            loadPattern(pattern) {
                document.getElementById('eyeDistance').value = pattern.size;
                document.getElementById('birdSpecies').value = pattern.species;
                this.currentStyle = pattern.style;
                
                // Update style selection
                document.querySelectorAll('.pattern-style-card').forEach(card => {
                    card.classList.remove('selected');
                    if (card.dataset.style === pattern.style) {
                        card.classList.add('selected');
                    }
                });
                
                this.updateSizeRecommendations();
                this.generatePattern();
                
                window.falconryApp.showNotification(`Loaded ${pattern.species} pattern`, 'success');
            }
        }
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            const generator = new HoodPatternGenerator();
            
            // Animate elements on load
            anime({
                targets: '.glass-card',
                opacity: [0, 1],
                translateY: [30, 0],
                delay: anime.stagger(100),
                duration: 600,
                easing: 'easeOutQuart'
            });
        });
    </script>
</body>
</html>