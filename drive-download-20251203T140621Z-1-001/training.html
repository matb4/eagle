<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Training Session - FalconPro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:wght@400;600;700&family=Inter:wght@300;400;500;600;700&family=Cinzel:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --forest-green: #2D5016;
            --warm-amber: #D4A574;
            --stone-gray: #6B7280;
            --copper-brown: #B45309;
            --sky-blue: #7DD3FC;
            --alert-red: #EF4444;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--forest-green) 0%, #1a3009 50%, var(--forest-green) 100%);
            background-size: 400% 400%;
            animation: gradientShift 20s ease infinite;
            min-height: 100vh;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .nav-link {
            position: relative;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover {
            color: var(--warm-amber);
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--warm-amber);
            transition: width 0.3s ease;
        }
        
        .nav-link:hover::after {
            width: 100%;
        }
        
        .bird-selector {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .bird-selector:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        
        .bird-selector.selected {
            border: 2px solid var(--warm-amber);
            transform: translateY(-4px);
        }
        
        .training-type-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .training-type-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }
        
        .training-type-card.selected {
            border: 2px solid var(--warm-amber);
            background: rgba(212, 165, 116, 0.2);
        }
        
        .progress-ring {
            transform: rotate(-90deg);
        }
        
        .progress-ring-circle {
            transition: stroke-dashoffset 0.35s;
            transform-origin: 50% 50%;
        }
        
        .session-timer {
            font-family: 'Cinzel', serif;
            font-size: 2rem;
            color: var(--warm-amber);
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 glass-card">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-amber-400 to-amber-600 rounded-lg flex items-center justify-center">
                        <span class="text-white font-bold text-lg">F</span>
                    </div>
                    <h1 class="text-xl font-bold text-white">FalconPro</h1>
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="index.html" class="nav-link text-white font-medium">Dashboard</a>
                    <a href="training.html" class="nav-link text-amber-400 font-medium">Training</a>
                    <a href="analytics.html" class="nav-link text-white font-medium">Analytics</a>
                    <a href="profiles.html" class="nav-link text-white font-medium">Profiles</a>
                    <a href="hood-generator.html" class="nav-link text-white font-medium">Hood Generator</a>
                </div>
                <div class="flex items-center space-x-3">
                    <img src="resources/falconer-portrait.jpg" alt="Falconer" class="w-8 h-8 rounded-full border-2 border-amber-400">
                    <span class="text-white text-sm hidden sm:block">Master Falconer</span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Training Session Interface -->
    <section class="pt-24 pb-12 px-4">
        <div class="max-w-7xl mx-auto">
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold text-white mb-4">Training Session Manager</h1>
                <p class="text-gray-200 max-w-2xl mx-auto">
                    Track your bird's training progress with precision. Record weight, performance, and behavioral observations.
                </p>
            </div>

            <!-- Training Progress Steps -->
            <div class="flex justify-center mb-8">
                <div class="flex items-center space-x-4">
                    <div class="flex items-center">
                        <div id="step1" class="w-8 h-8 bg-amber-600 text-white rounded-full flex items-center justify-center font-bold">1</div>
                        <span class="ml-2 text-white">Select Bird</span>
                    </div>
                    <div class="w-12 h-0.5 bg-gray-600"></div>
                    <div class="flex items-center">
                        <div id="step2" class="w-8 h-8 bg-gray-600 text-white rounded-full flex items-center justify-center font-bold">2</div>
                        <span class="ml-2 text-gray-400">Training Type</span>
                    </div>
                    <div class="w-12 h-0.5 bg-gray-600"></div>
                    <div class="flex items-center">
                        <div id="step3" class="w-8 h-8 bg-gray-600 text-white rounded-full flex items-center justify-center font-bold">3</div>
                        <span class="ml-2 text-gray-400">Session Data</span>
                    </div>
                    <div class="w-12 h-0.5 bg-gray-600"></div>
                    <div class="flex items-center">
                        <div id="step4" class="w-8 h-8 bg-gray-600 text-white rounded-full flex items-center justify-center font-bold">4</div>
                        <span class="ml-2 text-gray-400">Complete</span>
                    </div>
                </div>
            </div>

            <!-- Step 1: Bird Selection -->
            <div id="birdSelectionStep" class="step-content">
                <div class="glass-card rounded-xl p-6 mb-6">
                    <h2 class="text-2xl font-semibold text-white mb-6 text-center">Select Bird for Training</h2>
                    <div id="birdSelectionGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                        <!-- Bird selection cards will be populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Step 2: Training Type Selection -->
            <div id="trainingTypeStep" class="step-content hidden">
                <div class="glass-card rounded-xl p-6 mb-6">
                    <h2 class="text-2xl font-semibold text-white mb-6 text-center">Choose Training Type</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="training-type-card glass-card rounded-lg p-6 text-center" data-type="flight">
                            <div class="w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
                                <span class="text-2xl">ü¶Ö</span>
                            </div>
                            <h3 class="text-lg font-semibold text-white mb-2">Flight Training</h3>
                            <p class="text-gray-300 text-sm">Distance flying, altitude control, and aerial maneuvers</p>
                        </div>
                        <div class="training-type-card glass-card rounded-lg p-6 text-center" data-type="lure">
                            <div class="w-16 h-16 bg-amber-600 rounded-full flex items-center justify-center mx-auto mb-4">
                                <span class="text-2xl">üéØ</span>
                            </div>
                            <h3 class="text-lg font-semibold text-white mb-2">Lure Training</h3>
                            <p class="text-gray-300 text-sm">Hunting simulation with artificial prey and striking accuracy</p>
                        </div>
                        <div class="training-type-card glass-card rounded-lg p-6 text-center" data-type="recall">
                            <div class="w-16 h-16 bg-green-600 rounded-full flex items-center justify-center mx-auto mb-4">
                                <span class="text-2xl">üì¢</span>
                            </div>
                            <h3 class="text-lg font-semibold text-white mb-2">Recall Training</h3>
                            <p class="text-gray-300 text-sm">Response to calls and return to glove reliability</p>
                        </div>
                        <div class="training-type-card glass-card rounded-lg p-6 text-center" data-type="hunting">
                            <div class="w-16 h-16 bg-red-600 rounded-full flex items-center justify-center mx-auto mb-4">
                                <span class="text-2xl">üê∞</span>
                            </div>
                            <h3 class="text-lg font-semibold text-white mb-2">Hunting Simulation</h3>
                            <p class="text-gray-300 text-sm">Real prey tracking, pursuit, and capture techniques</p>
                        </div>
                        <div class="training-type-card glass-card rounded-lg p-6 text-center" data-type="weathering">
                            <div class="w-16 h-16 bg-purple-600 rounded-full flex items-center justify-center mx-auto mb-4">
                                <span class="text-2xl">‚òÄÔ∏è</span>
                            </div>
                            <h3 class="text-lg font-semibold text-white mb-2">Weathering</h3>
                            <p class="text-gray-300 text-sm">Outdoor exposure and environmental adaptation</p>
                        </div>
                        <div class="training-type-card glass-card rounded-lg p-6 text-center" data-type="conditioning">
                            <div class="w-16 h-16 bg-indigo-600 rounded-full flex items-center justify-center mx-auto mb-4">
                                <span class="text-2xl">üí™</span>
                            </div>
                            <h3 class="text-lg font-semibold text-white mb-2">Physical Conditioning</h3>
                            <p class="text-gray-300 text-sm">Strength building and endurance exercises</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 3: Session Data Entry -->
            <div id="sessionDataStep" class="step-content hidden">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Session Controls -->
                    <div class="glass-card rounded-xl p-6">
                        <h3 class="text-xl font-semibold text-white mb-6">Session Controls</h3>
                        
                        <!-- Timer Display -->
                        <div class="text-center mb-6">
                            <div class="session-timer" id="sessionTimer">00:00</div>
                            <p class="text-gray-300 text-sm">Session Duration</p>
                        </div>
                        
                        <!-- Control Buttons -->
                        <div class="flex justify-center space-x-4 mb-6">
                            <button id="startSessionBtn" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition-colors">
                                Start Session
                            </button>
                            <button id="pauseSessionBtn" class="bg-yellow-600 hover:bg-yellow-700 text-white px-6 py-2 rounded-lg transition-colors hidden">
                                Pause
                            </button>
                            <button id="endSessionBtn" class="bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg transition-colors hidden">
                                End Session
                            </button>
                        </div>
                        
                        <!-- Progress Ring -->
                        <div class="flex justify-center mb-6">
                            <div class="relative w-32 h-32">
                                <svg class="progress-ring w-32 h-32" viewBox="0 0 120 120">
                                    <circle cx="60" cy="60" r="50" stroke="rgba(255,255,255,0.2)" stroke-width="8" fill="transparent"/>
                                    <circle id="progressCircle" cx="60" cy="60" r="50" stroke="#D4A574" stroke-width="8" fill="transparent" 
                                            stroke-dasharray="314" stroke-dashoffset="314" class="progress-ring-circle"/>
                                </svg>
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <span id="progressPercent" class="text-white font-bold text-lg">0%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Data Entry Form -->
                    <div class="glass-card rounded-xl p-6">
                        <h3 class="text-xl font-semibold text-white mb-6">Session Data</h3>
                        
                        <form id="sessionDataForm" class="space-y-4">
                            <div>
                                <label class="block text-gray-200 mb-2">Pre-Training Weight (g)</label>
                                <input type="number" id="preWeight" class="w-full px-3 py-2 bg-white bg-opacity-20 border border-gray-400 rounded-lg text-white placeholder-gray-300" placeholder="Enter weight before training">
                            </div>
                            
                            <div>
                                <label class="block text-gray-200 mb-2">Food Given (g)</label>
                                <input type="number" id="foodGiven" class="w-full px-3 py-2 bg-white bg-opacity-20 border border-gray-400 rounded-lg text-white placeholder-gray-300" placeholder="Amount of food given">
                            </div>
                            
                            <div>
                                <label class="block text-gray-200 mb-2">Weather Conditions</label>
                                <select id="weatherConditions" class="w-full px-3 py-2 bg-white bg-opacity-20 border border-gray-400 rounded-lg text-white">
                                    <option value="Clear">Clear</option>
                                    <option value="Partly Cloudy">Partly Cloudy</option>
                                    <option value="Overcast">Overcast</option>
                                    <option value="Light Rain">Light Rain</option>
                                    <option value="Windy">Windy</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-gray-200 mb-2">Temperature (¬∞F)</label>
                                <input type="number" id="temperature" class="w-full px-3 py-2 bg-white bg-opacity-20 border border-gray-400 rounded-lg text-white placeholder-gray-300" placeholder="Enter temperature">
                            </div>
                            
                            <div>
                                <label class="block text-gray-200 mb-2">Behavioral Notes</label>
                                <textarea id="behaviorNotes" class="w-full px-3 py-2 bg-white bg-opacity-20 border border-gray-400 rounded-lg text-white placeholder-gray-300" rows="3" placeholder="Observations about behavior, performance, etc."></textarea>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Step 4: Session Summary -->
            <div id="sessionSummaryStep" class="step-content hidden">
                <div class="glass-card rounded-xl p-6">
                    <h2 class="text-2xl font-semibold text-white mb-6 text-center">Training Session Summary</h2>
                    
                    <div id="sessionSummary" class="space-y-6">
                        <!-- Summary content will be populated by JavaScript -->
                    </div>
                    
                    <div class="flex justify-center space-x-4 mt-8">
                        <button id="saveSessionBtn" class="bg-green-600 hover:bg-green-700 text-white px-8 py-3 rounded-lg transition-colors">
                            Save Session
                        </button>
                        <button id="startNewSessionBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg transition-colors">
                            Start New Session
                        </button>
                        <button onclick="window.location.href='analytics.html'" class="bg-purple-600 hover:bg-purple-700 text-white px-8 py-3 rounded-lg transition-colors">
                            View Analytics
                        </button>
                    </div>
                </div>
            </div>

            <!-- Navigation Buttons -->
            <div class="flex justify-between mt-8">
                <button id="prevBtn" class="bg-gray-600 hover:bg-gray-700 text-white px-6 py-2 rounded-lg transition-colors hidden">
                    Previous
                </button>
                <button id="nextBtn" class="bg-amber-600 hover:bg-amber-700 text-white px-6 py-2 rounded-lg transition-colors ml-auto">
                    Next
                </button>
            </div>
        </div>
    </section>

    <!-- Recent Training Sessions -->
    <section class="px-4 pb-12">
        <div class="max-w-7xl mx-auto">
            <div class="glass-card rounded-xl p-6">
                <h3 class="text-xl font-semibold text-white mb-6">Recent Training Sessions</h3>
                <div id="recentSessions" class="space-y-4">
                    <!-- Recent sessions will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </section>

    <script>
        // Training session state
        let currentStep = 1;
        let selectedBird = null;
        let selectedTrainingType = null;
        let sessionStartTime = null;
        let sessionDuration = 0;
        let sessionTimer = null;
        let isSessionActive = false;

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            initializeTrainingPage();
        });

        function initializeTrainingPage() {
            renderBirdSelection();
            renderRecentSessions();
            setupEventListeners();
            animateOnLoad();
        }

        function renderBirdSelection() {
            const grid = document.getElementById('birdSelectionGrid');
            grid.innerHTML = '';
            
            window.falconryApp.birdDatabase.forEach(bird => {
                const card = document.createElement('div');
                card.className = 'bird-selector glass-card rounded-lg p-4';
                card.onclick = () => selectBird(bird);
                
                const statusClass = `status-${bird.status}`;
                
                card.innerHTML = `
                    <div class="relative mb-3">
                        <img src="${bird.image}" alt="${bird.name}" class="w-full h-24 object-cover rounded-lg">
                        <div class="absolute top-2 right-2">
                            <div class="w-3 h-3 rounded-full ${statusClass}"></div>
                        </div>
                    </div>
                    <h3 class="text-lg font-semibold text-white mb-1">${bird.name}</h3>
                    <p class="text-gray-300 text-sm mb-2">${bird.species}</p>
                    <div class="flex justify-between text-sm text-gray-200">
                        <span>Weight: ${bird.weight}g</span>
                        <span>${bird.trainingLevel}</span>
                    </div>
                `;
                
                grid.appendChild(card);
            });
        }

        function selectBird(bird) {
            selectedBird = bird;
            
            // Update UI
            document.querySelectorAll('.bird-selector').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            
            // Enable next button
            document.getElementById('nextBtn').disabled = false;
        }

        function selectTrainingType(type) {
            selectedTrainingType = type;
            
            // Update UI
            document.querySelectorAll('.training-type-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            
            // Enable next button
            document.getElementById('nextBtn').disabled = false;
        }

        function nextStep() {
            if (currentStep === 1 && !selectedBird) {
                window.falconryApp.showNotification('Please select a bird first', 'error');
                return;
            }
            
            if (currentStep === 2 && !selectedTrainingType) {
                window.falconryApp.showNotification('Please select a training type', 'error');
                return;
            }
            
            if (currentStep < 4) {
                currentStep++;
                updateStepDisplay();
                showStep(currentStep);
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                updateStepDisplay();
                showStep(currentStep);
            }
        }

        function updateStepDisplay() {
            // Update step indicators
            for (let i = 1; i <= 4; i++) {
                const step = document.getElementById(`step${i}`);
                if (i <= currentStep) {
                    step.className = 'w-8 h-8 bg-amber-600 text-white rounded-full flex items-center justify-center font-bold';
                } else {
                    step.className = 'w-8 h-8 bg-gray-600 text-white rounded-full flex items-center justify-center font-bold';
                }
            }
            
            // Update navigation buttons
            document.getElementById('prevBtn').classList.toggle('hidden', currentStep === 1);
            document.getElementById('nextBtn').classList.toggle('hidden', currentStep === 4);
        }

        function showStep(step) {
            // Hide all steps
            document.querySelectorAll('.step-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // Show current step
            const stepElements = {
                1: 'birdSelectionStep',
                2: 'trainingTypeStep',
                3: 'sessionDataStep',
                4: 'sessionSummaryStep'
            };
            
            document.getElementById(stepElements[step]).classList.remove('hidden');
            
            // Animate step transition
            anime({
                targets: `#${stepElements[step]}`,
                opacity: [0, 1],
                translateY: [20, 0],
                duration: 500,
                easing: 'easeOutQuart'
            });
            
            // Initialize step-specific functionality
            if (step === 2) {
                initializeTrainingTypeSelection();
            } else if (step === 3) {
                initializeSessionData();
            } else if (step === 4) {
                generateSessionSummary();
            }
        }

        function initializeTrainingTypeSelection() {
            document.querySelectorAll('.training-type-card').forEach(card => {
                card.onclick = () => selectTrainingType(card.dataset.type);
            });
        }

        function initializeSessionData() {
            // Pre-fill bird weight
            document.getElementById('preWeight').value = selectedBird.weight;
            
            // Setup session controls
            document.getElementById('startSessionBtn').onclick = startSession;
            document.getElementById('pauseSessionBtn').onclick = pauseSession;
            document.getElementById('endSessionBtn').onclick = endSession;
        }

        function startSession() {
            if (!isSessionActive) {
                isSessionActive = true;
                sessionStartTime = Date.now();
                
                // Update UI
                document.getElementById('startSessionBtn').classList.add('hidden');
                document.getElementById('pauseSessionBtn').classList.remove('hidden');
                document.getElementById('endSessionBtn').classList.remove('hidden');
                
                // Start timer
                sessionTimer = setInterval(updateSessionTimer, 1000);
                
                window.falconryApp.showNotification('Training session started!', 'success');
            }
        }

        function pauseSession() {
            if (isSessionActive) {
                isSessionActive = false;
                clearInterval(sessionTimer);
                
                // Update UI
                document.getElementById('startSessionBtn').textContent = 'Resume';
                document.getElementById('startSessionBtn').classList.remove('hidden');
                document.getElementById('pauseSessionBtn').classList.add('hidden');
            }
        }

        function endSession() {
            isSessionActive = false;
            clearInterval(sessionTimer);
            sessionDuration = Date.now() - sessionStartTime;
            
            // Update UI
            document.getElementById('startSessionBtn').classList.remove('hidden');
            document.getElementById('pauseSessionBtn').classList.add('hidden');
            document.getElementById('endSessionBtn').classList.add('hidden');
            
            window.falconryApp.showNotification('Training session completed!', 'success');
        }

        function updateSessionTimer() {
            if (isSessionActive && sessionStartTime) {
                const elapsed = Date.now() - sessionStartTime;
                const minutes = Math.floor(elapsed / 60000);
                const seconds = Math.floor((elapsed % 60000) / 1000);
                
                document.getElementById('sessionTimer').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                // Update progress ring (example: 60 minutes = 100%)
                const progress = Math.min((elapsed / (60 * 60 * 1000)) * 100, 100);
                const circumference = 2 * Math.PI * 50;
                const offset = circumference - (progress / 100) * circumference;
                
                document.getElementById('progressCircle').style.strokeDashoffset = offset;
                document.getElementById('progressPercent').textContent = `${Math.round(progress)}%`;
            }
        }

        function generateSessionSummary() {
            const summaryContainer = document.getElementById('sessionSummary');
            const preWeight = document.getElementById('preWeight').value;
            const foodGiven = document.getElementById('foodGiven').value;
            const weather = document.getElementById('weatherConditions').value;
            const temperature = document.getElementById('temperature').value;
            const notes = document.getElementById('behaviorNotes').value;
            
            const duration = sessionDuration > 0 ? Math.floor(sessionDuration / 60000) : 0;
            
            summaryContainer.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white bg-opacity-10 rounded-lg p-4">
                        <h4 class="text-lg font-semibold text-white mb-3">Bird Information</h4>
                        <div class="space-y-2 text-gray-200">
                            <p><strong>Name:</strong> ${selectedBird.name}</p>
                            <p><strong>Species:</strong> ${selectedBird.species}</p>
                            <p><strong>Age:</strong> ${selectedBird.age} years</p>
                            <p><strong>Pre-training Weight:</strong> ${preWeight}g</p>
                        </div>
                    </div>
                    
                    <div class="bg-white bg-opacity-10 rounded-lg p-4">
                        <h4 class="text-lg font-semibold text-white mb-3">Session Details</h4>
                        <div class="space-y-2 text-gray-200">
                            <p><strong>Training Type:</strong> ${selectedTrainingType.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase())}</p>
                            <p><strong>Duration:</strong> ${duration} minutes</p>
                            <p><strong>Food Given:</strong> ${foodGiven}g</p>
                            <p><strong>Weather:</strong> ${weather}, ${temperature}¬∞F</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white bg-opacity-10 rounded-lg p-4">
                    <h4 class="text-lg font-semibold text-white mb-3">Behavioral Notes</h4>
                    <p class="text-gray-200">${notes || 'No notes recorded'}</p>
                </div>
                
                <div class="bg-white bg-opacity-10 rounded-lg p-4">
                    <h4 class="text-lg font-semibold text-white mb-3">Performance Assessment</h4>
                    <div class="flex items-center space-x-4">
                        <label class="text-gray-200">Success Rate:</label>
                        <div class="flex space-x-2">
                            ${[1,2,3,4,5].map(star => 
                                `<button class="text-2xl text-gray-400 hover:text-yellow-400" onclick="setRating(${star})">‚òÜ</button>`
                            ).join('')}
                        </div>
                        <span id="ratingText" class="text-gray-200">Click to rate</span>
                    </div>
                </div>
            `;
        }

        function setRating(rating) {
            const stars = document.querySelectorAll('.text-2xl');
            stars.forEach((star, index) => {
                if (index < rating) {
                    star.textContent = '‚òÖ';
                    star.className = 'text-2xl text-yellow-400';
                } else {
                    star.textContent = '‚òÜ';
                    star.className = 'text-2xl text-gray-400';
                }
            });
            
            const ratingText = document.getElementById('ratingText');
            const ratings = ['', 'Poor', 'Fair', 'Good', 'Very Good', 'Excellent'];
            ratingText.textContent = ratings[rating];
        }

        function saveSession() {
            // Collect all session data
            const sessionData = {
                birdId: selectedBird.id,
                date: new Date().toISOString().split('T')[0],
                type: selectedTrainingType,
                duration: sessionDuration > 0 ? Math.floor(sessionDuration / 60000) : 0,
                preWeight: document.getElementById('preWeight').value,
                foodGiven: document.getElementById('foodGiven').value,
                weather: document.getElementById('weatherConditions').value,
                temperature: document.getElementById('temperature').value,
                notes: document.getElementById('behaviorNotes').value,
                success: 85 // Placeholder - would be calculated based on performance
            };
            
            // Add to training sessions
            window.falconryApp.trainingSessions.unshift(sessionData);
            
            // Update bird's last trained date
            selectedBird.lastTrained = sessionData.date;
            
            window.falconryApp.showNotification('Training session saved successfully!', 'success');
            
            // Redirect to analytics
            setTimeout(() => {
                window.location.href = 'analytics.html';
            }, 1500);
        }

        function startNewSession() {
            // Reset all state
            currentStep = 1;
            selectedBird = null;
            selectedTrainingType = null;
            sessionStartTime = null;
            sessionDuration = 0;
            isSessionActive = false;
            
            // Reset UI
            document.querySelectorAll('.bird-selector').forEach(card => {
                card.classList.remove('selected');
            });
            document.querySelectorAll('.training-type-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Reset forms
            document.getElementById('sessionDataForm').reset();
            document.getElementById('sessionTimer').textContent = '00:00';
            document.getElementById('progressCircle').style.strokeDashoffset = '314';
            document.getElementById('progressPercent').textContent = '0%';
            
            // Show first step
            showStep(1);
            updateStepDisplay();
        }

        function renderRecentSessions() {
            const container = document.getElementById('recentSessions');
            container.innerHTML = '';
            
            const recentSessions = window.falconryApp.trainingSessions.slice(0, 5);
            
            recentSessions.forEach(session => {
                const bird = window.falconryApp.getBirdById(session.birdId);
                const sessionElement = document.createElement('div');
                sessionElement.className = 'flex items-center justify-between p-4 bg-white bg-opacity-10 rounded-lg';
                
                sessionElement.innerHTML = `
                    <div class="flex items-center space-x-4">
                        <img src="${bird.image}" alt="${bird.name}" class="w-12 h-12 rounded-lg object-cover">
                        <div>
                            <h4 class="text-white font-medium">${bird.name}</h4>
                            <p class="text-gray-300 text-sm">${session.type}</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="text-white font-medium">${session.success}% success</p>
                        <p class="text-gray-300 text-sm">${session.duration} min</p>
                    </div>
                `;
                
                container.appendChild(sessionElement);
            });
        }

        function setupEventListeners() {
            document.getElementById('nextBtn').onclick = nextStep;
            document.getElementById('prevBtn').onclick = prevStep;
            document.getElementById('saveSessionBtn').onclick = saveSession;
            document.getElementById('startNewSessionBtn').onclick = startNewSession;
        }

        function animateOnLoad() {
            anime({
                targets: '.glass-card',
                opacity: [0, 1],
                translateY: [30, 0],
                delay: anime.stagger(100),
                duration: 600,
                easing: 'easeOutQuart'
            });
        }
    </script>
</body>
</html>